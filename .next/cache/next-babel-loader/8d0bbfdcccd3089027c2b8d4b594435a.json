{"ast":null,"code":"var _jsxFileName = \"/Users/phan/Desktop/Integrify/fullstack-graphql-next-nexus-prisma/pages/products/index.tsx\";\nvar __jsx = React.createElement;\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React, { useState } from \"react\";\nimport useStyles from \"./style\";\nimport { Card, CardMedia, CardContent, Typography, CardActionArea, CardActions, Button } from \"@material-ui/core\";\nimport Loading from \"../../components/Loading\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport Pagination from \"@material-ui/lab/Pagination\";\nimport PaginationItem from \"@material-ui/lab/PaginationItem\";\nimport Skeleton from \"@material-ui/lab/Skeleton\";\nimport Box from \"@material-ui/core/Box\";\nimport { PrismaClient } from \"@prisma/client\";\nimport { request } from \"graphql-request\";\nimport useSWR from \"swr\";\nconst prisma2 = new PrismaClient();\nimport CustomModal from '../../components/Modal';\nimport Router from \"next/router\";\nimport LazyLoad from 'react-lazyload';\nconst take = \"9\";\nconst API = \"http://localhost:3000/api/graphql\";\n\nconst fetcher = (query, skip, take) => request(API, query, {\n  skip,\n  take\n});\n\nconst ALL_PRODUCTS2 =\n/* GraphQL */\n`\n  query allProducts($skip: String!, $take: String!) {\n    allProducts(skip: $skip, take: $take) {\n      id\n      name\n    }\n  }\n`;\nexport default function Products({\n  skip,\n  products,\n  numberPages\n}) {\n  const classes = useStyles();\n  const {\n    0: open,\n    1: setOpen\n  } = useState(false);\n  const {\n    0: openEdit,\n    1: setOpenEdit\n  } = useState(false);\n  const {\n    0: activeProduct,\n    1: setActiveProduct\n  } = useState();\n  const {\n    data\n  } = useSWR([ALL_PRODUCTS2, skip, take], {\n    initialData: products\n  });\n  const updatedProducts = data || [];\n  const loading = !data;\n  const router = useRouter();\n\n  if (router.isFallback || loading) {\n    return __jsx(Loading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 12\n      }\n    });\n  }\n\n  const handleOnclickDeleteBtn = async (product, e) => {\n    await handleOpen(e); // Active product. ...\n\n    await setActiveProduct(product);\n  };\n\n  const redirectRouting = async currentPage => {\n    await Router.replace(`/products/${currentPage}`, `/products/${currentPage}`, {\n      shallow: true\n    });\n  };\n\n  const handleOpen = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    setOpen(true);\n  };\n\n  const handleClose = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    setOpen(false);\n  };\n\n  const handleOpenOrCloseEdit = e => {\n    e.preventDefault();\n    setOpenEdit(!openEdit);\n  };\n\n  const productArray = Object.keys(updatedProducts).map(k => updatedProducts[k])[0];\n  return __jsx(\"div\", {\n    className: classes.wrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 5\n    }\n  }, open && activeProduct && __jsx(CustomModal, {\n    handleOpen: handleOpen,\n    product: activeProduct,\n    handleClose: handleClose,\n    open: open,\n    redirectRouting: redirectRouting,\n    currentPage: router.query.page || 1,\n    isEdit: false // @ts-ignore\n    ,\n    products: productArray || products || [],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 26\n    }\n  }), openEdit ? __jsx(CustomModal, {\n    redirectRouting: redirectRouting,\n    product: activeProduct,\n    currentPage: router.query.page || 1,\n    handleClose: handleOpenOrCloseEdit,\n    handleOpen: handleOpenOrCloseEdit,\n    open: openEdit,\n    isEdit: true // @ts-ignore\n    ,\n    products: productArray || products || [],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 19\n    }\n  }) : null, __jsx(\"div\", {\n    className: classes.content__tittle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 9\n    }\n  }, \"POPULAR PRODUCTS\")), __jsx(Box, {\n    className: classes.content__pagination,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }\n  }, numberPages > 0 || !router.isFallback ? __jsx(Pagination, {\n    page: parseInt(router.query.page || \"1\"),\n    count: numberPages,\n    defaultPage: 1,\n    renderItem: item => __jsx(PaginationItem, _extends({\n      component: MaterialUiLink,\n      query: router.query || 1,\n      item: item\n    }, item, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 15\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 11\n    }\n  }) : __jsx(Skeleton, {\n    variant: \"rect\",\n    width: \"30vw\",\n    height: \"28px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 11\n    }\n  })), __jsx(\"div\", {\n    className: classes.content__items,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 7\n    }\n  }, products && products.length > 0 || !router.isFallback ? // @ts-ignore\n  productArray === null || productArray === void 0 ? void 0 : productArray.map((p, i) => {\n    return __jsx(Box, {\n      className: classes.lazyLoading,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 15\n      }\n    }, __jsx(LazyLoad, {\n      key: p.id,\n      height: 3,\n      offset: [-3, 3],\n      placeholder: __jsx(Loading, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 32\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 17\n      }\n    }, __jsx(Link, {\n      href: \"/products/details/[id]\",\n      as: `/products/details/${p.id}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 19\n      }\n    }, __jsx(Card, {\n      key: i,\n      className: classes.content__item,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 21\n      }\n    }, __jsx(CardActionArea, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 23\n      }\n    }, __jsx(CardMedia, {\n      className: classes.item__media,\n      image: \"https://cdn.bike24.net/i/mb/d8/fa/b2/277893-00-d-557791.jpg\",\n      title: \"Contemplative Reptile\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 25\n      }\n    }), __jsx(CardContent, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 25\n      }\n    }, __jsx(Typography, {\n      gutterBottom: true,\n      variant: \"h5\",\n      component: \"h2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 27\n      }\n    }, p === null || p === void 0 ? void 0 : p.name), __jsx(Typography, {\n      variant: \"body2\",\n      color: \"textSecondary\",\n      component: \"p\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 27\n      }\n    }, \"Maximum impact cushioning. The brutal, repetitive, downward force of sport can wreak havoc on the body and on performance. Max Air cushioning is specifically engineered to handle these impacts and provide protection. Max Air is big air designed to take a pounding.\"), __jsx(Typography, {\n      className: classes.item__price,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 27\n      }\n    }, \"PRICE: 60.0 Euro\"))), __jsx(CardActions, {\n      className: classes.item__buttons,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 23\n      }\n    }, __jsx(Box, {\n      component: \"div\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 25\n      }\n    }, __jsx(Button, {\n      size: \"small\",\n      color: \"primary\",\n      className: classes.button__addToCart,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 27\n      }\n    }, \"Add To Cart\"), __jsx(Button, {\n      size: \"small\",\n      color: \"primary\",\n      onClick: handleOpenOrCloseEdit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 27\n      }\n    }, \"EDIT\")), __jsx(Button, {\n      size: \"small\",\n      color: \"primary\",\n      onClick: e => handleOnclickDeleteBtn(p, e),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 25\n      }\n    }, \"Delete\"))))));\n  }) : __jsx(Box, {\n    className: classes.content__skeleton,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 11\n    }\n  }, __jsx(Skeleton, {\n    variant: \"rect\",\n    width: \"28vw\",\n    height: \"720px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 13\n    }\n  }), __jsx(\"div\", {\n    className: classes.wrapper__loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 13\n    }\n  }, __jsx(Loading, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 15\n    }\n  })))));\n}\nexport const getStaticProps = async ctx => {\n  var _ctx$params;\n\n  const pageQuery = (ctx === null || ctx === void 0 ? void 0 : (_ctx$params = ctx.params) === null || _ctx$params === void 0 ? void 0 : _ctx$params.page) || 1;\n  const skip = String((parseInt(pageQuery) - 1) * +take);\n  const productsOfPage = await prisma2.product.findMany({\n    skip: +skip,\n    take: +take\n  });\n  const productsArray = Object.keys(productsOfPage).map(k => totalProducts[parseInt(k)]);\n  const numberPages = Math.ceil(((productsArray === null || productsArray === void 0 ? void 0 : productsArray.length) || 0) / +take); // const {  data } = await client.query({\n  //   query: ALL_PRODUCTS,\n  //   variables: {\n  //     skip: skip,\n  //     take: take\n  //   }\n  // })\n\n  console.log('productsArray', productsArray);\n  const products = await fetcher(ALL_PRODUCTS2, skip, take);\n  console.log('products', products); // const products = Object.keys(data).map((k) => data[k])[0]\n  // console.log(' server build...', data)\n  //   const deleteItem = await fetcher(REMOVE_PRODUCT_BY_ID, skip, take);\n  // console.log('deleteItem:', deleteItem);\n\n  return {\n    props: {\n      products,\n      numberPages,\n      skip\n    }\n  };\n};\nexport function MaterialUiLink(_ref) {\n  let {\n    item,\n    query\n  } = _ref,\n      props = _objectWithoutProperties(_ref, [\"item\", \"query\"]);\n\n  // const router = useRouter();\n  // if ( !router.query.page)\n  //   return (\n  //     <Link href=\"/products\" as={`/products`}>\n  //       <a {...props}></a>\n  //     </Link>\n  //   );\n  return __jsx(Link, {\n    href: \"/products/[page]\",\n    as: `/products/${item.page}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 5\n    }\n  }, __jsx(\"a\", _extends({}, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 7\n    }\n  })));\n}","map":{"version":3,"sources":["/Users/phan/Desktop/Integrify/fullstack-graphql-next-nexus-prisma/pages/products/index.tsx"],"names":["React","useState","useStyles","Card","CardMedia","CardContent","Typography","CardActionArea","CardActions","Button","Loading","Link","useRouter","Pagination","PaginationItem","Skeleton","Box","PrismaClient","request","useSWR","prisma2","CustomModal","Router","LazyLoad","take","API","fetcher","query","skip","ALL_PRODUCTS2","Products","products","numberPages","classes","open","setOpen","openEdit","setOpenEdit","activeProduct","setActiveProduct","data","initialData","updatedProducts","loading","router","isFallback","handleOnclickDeleteBtn","product","e","handleOpen","redirectRouting","currentPage","replace","shallow","preventDefault","stopPropagation","handleClose","handleOpenOrCloseEdit","productArray","Object","keys","map","k","wrapper","page","content__tittle","content__pagination","parseInt","item","MaterialUiLink","content__items","length","p","i","lazyLoading","id","content__item","item__media","name","item__price","item__buttons","button__addToCart","content__skeleton","wrapper__loading","getStaticProps","ctx","pageQuery","params","String","productsOfPage","findMany","productsArray","totalProducts","Math","ceil","console","log","props"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport useStyles from \"./style\";\nimport { PaginationRenderItemParams } from \"@material-ui/lab\";\nimport {\n  Card,\n  CardMedia,\n  CardContent,\n  Typography,\n  CardActionArea,\n  CardActions,\n  Button,\n} from \"@material-ui/core\";\nimport { GetStaticProps } from \"next\";\nimport Loading from \"../../components/Loading\";\nimport { Product } from \"../../interfaces\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport Pagination from \"@material-ui/lab/Pagination\";\nimport PaginationItem from \"@material-ui/lab/PaginationItem\";\nimport Skeleton from \"@material-ui/lab/Skeleton\";\nimport Box from \"@material-ui/core/Box\";\nimport { ParsedUrlQuery } from \"querystring\";\nimport { PrismaClient } from \"@prisma/client\";\nimport { request } from \"graphql-request\";\nimport useSWR from \"swr\";\nconst prisma2 = new PrismaClient();\nimport CustomModal from '../../components/Modal';\nimport Router from \"next/router\";\nimport LazyLoad from 'react-lazyload';\n\nconst take = \"9\";\n\nconst API = \"http://localhost:3000/api/graphql\";\nconst fetcher = (query: any, skip: string, take: string) =>\n  request(API, query, { skip, take });\n\n\nconst ALL_PRODUCTS2 = /* GraphQL */ `\n  query allProducts($skip: String!, $take: String!) {\n    allProducts(skip: $skip, take: $take) {\n      id\n      name\n    }\n  }\n`;\n\n\nexport interface IProducts {\n  products: Product[];\n  numberPages: number;\n  skip: string;\n}\n\nexport default function Products({ skip, products, numberPages }: IProducts) {\n  const classes = useStyles();\n  const [open, setOpen] = useState(false);\n  const [openEdit, setOpenEdit] = useState(false);\n  const [activeProduct, setActiveProduct] = useState<Product>();\n\n  const { data } = useSWR([ALL_PRODUCTS2, skip, take], {\n    initialData: products,\n  });\n  const updatedProducts: Product[] = data! || [];\n  const loading: boolean = !data;\n\n  const router = useRouter();\n  if (router.isFallback || loading) {\n    return <Loading />;\n  }\n\n  const handleOnclickDeleteBtn = async ( product: Product, e: any) => {\n    await handleOpen(e);// Active product. ...\n    await setActiveProduct(product);\n  }\n\n  const redirectRouting = async (currentPage: string) => {\n    await Router.replace(`/products/${currentPage}`,  `/products/${currentPage}`, {shallow: true})\n  }\n\n  const handleOpen = (e: any) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setOpen(true);\n  };\n\n  const handleClose = (e: any) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setOpen(false);\n  };\n\n  const handleOpenOrCloseEdit = (e: any) => {\n    e.preventDefault();\n    setOpenEdit(!openEdit);\n  };\n\n  const productArray = Object.keys(updatedProducts).map(\n    (k) => updatedProducts[k as any]\n  )[0];\n\n  return (\n    <div className={classes.wrapper}>\n      {/* Break component ===>  */}\n      {open && (\n        activeProduct && <CustomModal\n            handleOpen={handleOpen}\n            product={activeProduct!}\n            handleClose={handleClose}\n            open={open}\n            redirectRouting={redirectRouting}\n            currentPage= {(router.query.page || 1) as string}\n            isEdit={false}\n          // @ts-ignore\n            products ={productArray || products || []}\n        />\n\n      )}\n      {openEdit? (<CustomModal\n          redirectRouting={redirectRouting}\n          product={activeProduct!}\n          currentPage= {(router.query.page || 1) as string}\n          handleClose={handleOpenOrCloseEdit}\n          handleOpen={handleOpenOrCloseEdit}\n          open={openEdit}\n          isEdit={true}\n          // @ts-ignore\n          products ={productArray || products || []}\n        />)\n        :null\n      }\n      <div className={classes.content__tittle}>\n        <div>POPULAR PRODUCTS</div>\n      </div>\n      <Box className={classes.content__pagination}>\n        {numberPages > 0 || !router.isFallback ? (\n          <Pagination\n            page={parseInt((router.query.page as string) || \"1\")}\n            count={numberPages}\n            defaultPage={1}\n            renderItem={(item) => (\n              <PaginationItem\n                component={MaterialUiLink}\n                query={router.query || 1}\n                item={item}\n                {...item}\n              />\n            )}\n          />\n        ) : (\n          <Skeleton variant=\"rect\" width={\"30vw\"} height={\"28px\"} />\n        )}\n      </Box>\n      <div className={classes.content__items}>\n        {(products && products.length > 0) || !router.isFallback ? (\n          // @ts-ignore\n          productArray?.map((p: Product, i: any) => {\n            return (\n              <Box className={classes.lazyLoading}>\n                <LazyLoad\n                  key={p!.id}\n                  height={3}\n                  offset={[-3,3]}\n                  placeholder={<Loading/>}\n                >\n                  <Link\n                    href=\"/products/details/[id]\"\n                    as={`/products/details/${p.id}`}\n                  >\n                    <Card key={i} className={classes.content__item}>\n                      <CardActionArea>\n                        <CardMedia\n                          className={classes.item__media}\n                          image=\"https://cdn.bike24.net/i/mb/d8/fa/b2/277893-00-d-557791.jpg\"\n                          title=\"Contemplative Reptile\"\n                        />\n                        <CardContent>\n                          <Typography gutterBottom variant=\"h5\" component=\"h2\">\n                            {p?.name}\n                          </Typography>\n                          <Typography\n                            variant=\"body2\"\n                            color=\"textSecondary\"\n                            component=\"p\"\n                          >\n                            Maximum impact cushioning. The brutal, repetitive,\n                            downward force of sport can wreak havoc on the body and\n                            on performance. Max Air cushioning is specifically\n                            engineered to handle these impacts and provide\n                            protection. Max Air is big air designed to take a\n                            pounding.\n                          </Typography>\n                          <Typography className={classes.item__price}>\n                            PRICE: 60.0 Euro\n                          </Typography>\n                        </CardContent>\n                      </CardActionArea>\n                      <CardActions className={classes.item__buttons}>\n                        <Box component=\"div\">\n                          <Button\n                            size=\"small\"\n                            color=\"primary\"\n                            className={classes.button__addToCart}\n                          >\n                            Add To Cart\n                          </Button>\n                          <Button size=\"small\" color=\"primary\" onClick={handleOpenOrCloseEdit}>\n                            EDIT\n                          </Button>\n                        </Box>\n                        {/* Set active product ===> nhu */}\n                        <Button\n                          size=\"small\"\n                          color=\"primary\"\n                          onClick={(e) => handleOnclickDeleteBtn(p, e)}\n                        >\n                          Delete\n                        </Button>\n                      </CardActions>\n                    </Card>\n                  </Link>\n                </LazyLoad>\n              </Box>\n            );\n          })\n        ) : (\n          <Box className={classes.content__skeleton}>\n            <Skeleton variant=\"rect\" width={\"28vw\"} height={\"720px\"} />\n            <div className={classes.wrapper__loading}>\n              <Loading />\n            </div>\n          </Box>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport const getStaticProps: GetStaticProps = async (ctx) => {\n  const pageQuery = (ctx?.params?.page || 1) as string;\n  const skip = String((parseInt(pageQuery) - 1) * +take);\n  const productsOfPage = await prisma2.product.findMany({\n    skip: +skip,\n    take: +take\n  });\n  const productsArray = Object.keys(productsOfPage).map(\n    (k) => totalProducts[parseInt(k)]\n  );\n  const numberPages = Math.ceil(\n    ((productsArray?.length || 0) as number) / +take\n  ) as number;\n\n\n\n\n  // const {  data } = await client.query({\n  //   query: ALL_PRODUCTS,\n  //   variables: {\n  //     skip: skip,\n  //     take: take\n  //   }\n  // })\n\n  console.log('productsArray', productsArray)\n  const products = await fetcher(ALL_PRODUCTS2, skip, take);\n  console.log('products', products)\n\n  // const products = Object.keys(data).map((k) => data[k])[0]\n  // console.log(' server build...', data)\n  //   const deleteItem = await fetcher(REMOVE_PRODUCT_BY_ID, skip, take);\n  // console.log('deleteItem:', deleteItem);\n  return {\n    props: {\n      products,\n      numberPages,\n      skip,\n    },\n  };\n};\n\nexport interface MaterialUiLinkProps {\n  item: PaginationRenderItemParams;\n  query: ParsedUrlQuery;\n}\n\nexport function MaterialUiLink({ item, query, ...props }: MaterialUiLinkProps) {\n  // const router = useRouter();\n  // if ( !router.query.page)\n  //   return (\n  //     <Link href=\"/products\" as={`/products`}>\n  //       <a {...props}></a>\n  //     </Link>\n  //   );\n\n  return (\n    <Link href=\"/products/[page]\" as={`/products/${item.page}`}>\n      <a {...props}></a>\n    </Link>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}