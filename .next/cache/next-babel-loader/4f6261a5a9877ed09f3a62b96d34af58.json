{"ast":null,"code":"var _jsxFileName = \"/Users/phan/Desktop/Integrify/fullstack-graphql-next-nexus-prisma/pages/products/[page].tsx\";\nvar __jsx = React.createElement;\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React, { useState } from \"react\";\nimport useStyles from \"./style\";\nimport { Card, CardMedia, CardContent, Typography, CardActionArea, CardActions, Button, Backdrop, Fade } from \"@material-ui/core\";\nimport Loading from \"../../components/Loading\";\nimport { gql } from \"@apollo/client\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport Pagination from \"@material-ui/lab/Pagination\";\nimport PaginationItem from \"@material-ui/lab/PaginationItem\";\nimport Skeleton from \"@material-ui/lab/Skeleton\";\nimport Box from \"@material-ui/core/Box\";\nimport { PrismaClient } from \"@prisma/client\";\nimport { request } from \"graphql-request\";\nimport useSWR, { mutate, trigger } from \"swr\";\nconst prisma2 = new PrismaClient(); // import Modal from '../../components/Modal';\n\nimport Router from \"next/router\";\nimport { Modal } from \"@material-ui/core\";\nconst take = \"3\";\n\nconst sleep = time => new Promise(acc => setTimeout(acc, time));\n\nconst API = \"http://localhost:3000/api/graphql\";\n\nconst fetcher = (query, skip, take) => request(API, query, {\n  skip,\n  take\n});\n\nconst ALL_PRODUCTS = gql`\n    query allProducts($skip: String!, $take: String!) {\n        allProducts(skip: $skip, take: $take) {\n            id\n            name\n        }\n    }\n`;\nconst ALL_PRODUCTS2 =\n/* GraphQL */\n`\n  query allProducts($skip: String!, $take: String!) {\n    allProducts(skip: $skip, take: $take) {\n      id\n      name\n    }\n  }\n`;\n/* GraphQL */\n\nconst REMOVE_PRODUCT =\n/* GraphQL */\n`\n  mutation removeProductById($id: String!) {\n    removeProductById(id: $id) {\n      id\n      name\n    }\n  }\n`;\n/* GraphQL */\n\nconst CREATE_PRODUCT2 =\n/* GraphQL */\n`\n  mutation createNewOneProduct($name: String!) {\n    createNewOneProduct(name: $name) {\n      id\n      name\n    }\n  }\n`;\nexport default function Products({\n  skip,\n  products,\n  numberPages\n}) {\n  const classes = useStyles();\n  const {\n    data\n  } = useSWR([ALL_PRODUCTS2, skip, take], {\n    initialData: products\n  });\n  const updatedProducts = data || [];\n  const loading = !data; // console.log('products1', products)\n\n  console.log(\"data......---\", data);\n  const router = useRouter();\n\n  if (router.isFallback || loading) {\n    return __jsx(Loading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 12\n      }\n    });\n  } //modal function\n\n\n  const {\n    0: open,\n    1: setOpen\n  } = useState(false);\n\n  const handleOpen = e => {\n    console.log(\"event delete\", e);\n    e.preventDefault();\n    e.stopPropagation();\n    setOpen(true);\n  };\n\n  const handleClose = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    setOpen(false);\n  };\n\n  const handleRemoveInModal = async (e, id) => {\n    await sleep(2000);\n    console.log(\"event remove\", e);\n    e.preventDefault();\n    e.stopPropagation();\n    console.log(\"id...\", typeof id, id);\n    await mutate(API);\n    const data1 = await request(API, REMOVE_PRODUCT, {\n      id: id\n    }); // const { createNewOneProduct } = await request(API, CREATE_PRODUCT2, {\n    //   name: id,\n    // });\n\n    console.log(\"data check.....-> \", data1);\n    await trigger(API);\n    await Router.push(`/products`);\n  };\n\n  const productArray = Object.keys(updatedProducts).map(k => updatedProducts[k])[0];\n  const {\n    0: activeProduct,\n    1: setActiveProduct\n  } = useState(null);\n  return __jsx(\"div\", {\n    className: classes.wrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 5\n    }\n  }, open && __jsx(Modal, {\n    className: classes.modal,\n    open: open,\n    onClose: handleClose,\n    closeAfterTransition: true,\n    BackdropComponent: Backdrop,\n    BackdropProps: {\n      timeout: 500\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 9\n    }\n  }, __jsx(Fade, {\n    in: open,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 11\n    }\n  }, __jsx(\"div\", {\n    className: classes.paper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 13\n    }\n  }, __jsx(\"h2\", {\n    id: \"transition-modal-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 15\n    }\n  }, \"DELETE THIS PRODUCT\"), __jsx(\"p\", {\n    id: \"transition-modal-description\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 15\n    }\n  }, \"Do you want to delete this item?.\"), __jsx(Button, {\n    size: \"small\",\n    variant: \"contained\",\n    color: \"primary\",\n    onClick: async e => {\n      await handleRemoveInModal(e, activeProduct === null || activeProduct === void 0 ? void 0 : activeProduct.id);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 15\n    }\n  }, \"REMOVE\"), __jsx(Button, {\n    size: \"small\",\n    variant: \"outlined\",\n    color: \"default\",\n    onClick: handleClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 15\n    }\n  }, \"CANCEL\")))), __jsx(\"div\", {\n    className: classes.content__tittle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 9\n    }\n  }, \"POPULAR PRODUCTS\")), __jsx(Box, {\n    className: classes.content__pagination,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 7\n    }\n  }, numberPages > 0 || !router.isFallback ? __jsx(Pagination, {\n    page: parseInt(router.query.page || \"1\"),\n    count: numberPages,\n    defaultPage: 1,\n    renderItem: item => __jsx(PaginationItem, _extends({\n      component: MaterialUiLink,\n      query: router.query,\n      item: item\n    }, item, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 15\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 11\n    }\n  }) : __jsx(Skeleton, {\n    variant: \"rect\",\n    width: \"30vw\",\n    height: \"28px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 11\n    }\n  })), __jsx(\"div\", {\n    className: classes.content__items,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 7\n    }\n  }, products && products.length > 0 || !router.isFallback ? productArray === null || productArray === void 0 ? void 0 : productArray.map((p, i) => {\n    return __jsx(Link, {\n      href: \"/products/details/[id]\",\n      as: `/products/details/${p.id}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 15\n      }\n    }, __jsx(Card, {\n      key: i,\n      className: classes.content__item,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 17\n      }\n    }, __jsx(CardActionArea, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 19\n      }\n    }, __jsx(CardMedia, {\n      className: classes.item__media,\n      image: \"https://cdn.bike24.net/i/mb/d8/fa/b2/277893-00-d-557791.jpg\",\n      title: \"Contemplative Reptile\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 21\n      }\n    }), __jsx(CardContent, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 21\n      }\n    }, __jsx(Typography, {\n      gutterBottom: true,\n      variant: \"h5\",\n      component: \"h2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 23\n      }\n    }, p === null || p === void 0 ? void 0 : p.name), __jsx(Typography, {\n      variant: \"body2\",\n      color: \"textSecondary\",\n      component: \"p\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 23\n      }\n    }, \"Maximum impact cushioning. The brutal, repetitive, downward force of sport can wreak havoc on the body and on performance. Max Air cushioning is specifically engineered to handle these impacts and provide protection. Max Air is big air designed to take a pounding.\"), __jsx(Typography, {\n      className: classes.item__price,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 23\n      }\n    }, \"PRICE: 60.0 Euro\"))), __jsx(CardActions, {\n      className: classes.item__buttons,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 19\n      }\n    }, __jsx(Box, {\n      component: \"div\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 21\n      }\n    }, __jsx(Button, {\n      size: \"small\",\n      color: \"primary\",\n      className: classes.button__addToCart,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 23\n      }\n    }, \"Add To Cart\"), __jsx(Button, {\n      size: \"small\",\n      color: \"primary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 23\n      }\n    }, \"Learn More\")), __jsx(Button, {\n      size: \"small\",\n      color: \"primary\",\n      onClick: e => {\n        handleOpen(e); // Active product. ...\n\n        setActiveProduct(p);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 21\n      }\n    }, \"Delete\"))));\n  }) : __jsx(Box, {\n    className: classes.content__skeleton,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 11\n    }\n  }, __jsx(Skeleton, {\n    variant: \"rect\",\n    width: \"28vw\",\n    height: \"720px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 13\n    }\n  }), __jsx(\"div\", {\n    className: classes.wrapper__loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 13\n    }\n  }, __jsx(Loading, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 15\n    }\n  })))));\n}\nexport const getStaticProps = async ctx => {\n  var _ctx$params;\n\n  const totalProducts = await prisma2.product.findMany();\n  const productsArray = Object.keys(totalProducts).map(k => totalProducts[parseInt(k)]);\n  const numberPages = Math.ceil(((productsArray === null || productsArray === void 0 ? void 0 : productsArray.length) || 0) / +take);\n  const pageQuery = (ctx === null || ctx === void 0 ? void 0 : (_ctx$params = ctx.params) === null || _ctx$params === void 0 ? void 0 : _ctx$params.page) || 1;\n  const skip = String((parseInt(pageQuery) - 1) * +take); // const {  data } = await client.query({\n  //   query: ALL_PRODUCTS,\n  //   variables: {\n  //     skip: skip,\n  //     take: take\n  //   }\n  // })\n\n  const products = await fetcher(ALL_PRODUCTS2, skip, take);\n  console.log(\"products2\", products); // const products = Object.keys(data).map((k) => data[k])[0]\n  // console.log(' server build...', data)\n  //   const deleteItem = await fetcher(REMOVE_PRODUCT_BY_ID, skip, take);\n  // console.log('deleteItem:', deleteItem);\n\n  return {\n    props: {\n      products,\n      numberPages,\n      skip\n    }\n  };\n};\nexport const getStaticPaths = async () => {\n  return {\n    paths: [{\n      params: {\n        page: \"1\"\n      }\n    }, {\n      params: {\n        page: \"2\"\n      }\n    }, {\n      params: {\n        page: \"3\"\n      }\n    }],\n    fallback: true\n  };\n};\nexport function MaterialUiLink(_ref) {\n  let {\n    item,\n    query\n  } = _ref,\n      props = _objectWithoutProperties(_ref, [\"item\", \"query\"]);\n\n  return __jsx(Link, {\n    href: \"/products/[page]\",\n    as: `/products/${item.page}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 5\n    }\n  }, __jsx(\"a\", _extends({}, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 335,\n      columnNumber: 7\n    }\n  })));\n}","map":{"version":3,"sources":["/Users/phan/Desktop/Integrify/fullstack-graphql-next-nexus-prisma/pages/products/[page].tsx"],"names":["React","useState","useStyles","Card","CardMedia","CardContent","Typography","CardActionArea","CardActions","Button","Backdrop","Fade","Loading","gql","Link","useRouter","Pagination","PaginationItem","Skeleton","Box","PrismaClient","request","useSWR","mutate","trigger","prisma2","Router","Modal","take","sleep","time","Promise","acc","setTimeout","API","fetcher","query","skip","ALL_PRODUCTS","ALL_PRODUCTS2","REMOVE_PRODUCT","CREATE_PRODUCT2","Products","products","numberPages","classes","data","initialData","updatedProducts","loading","console","log","router","isFallback","open","setOpen","handleOpen","e","preventDefault","stopPropagation","handleClose","handleRemoveInModal","id","data1","push","productArray","Object","keys","map","k","activeProduct","setActiveProduct","wrapper","modal","timeout","paper","content__tittle","content__pagination","parseInt","page","item","MaterialUiLink","content__items","length","p","i","content__item","item__media","name","item__price","item__buttons","button__addToCart","content__skeleton","wrapper__loading","getStaticProps","ctx","totalProducts","product","findMany","productsArray","Math","ceil","pageQuery","params","String","props","getStaticPaths","paths","fallback"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;AACA,OAAOC,SAAP,MAAsB,SAAtB;AAEA,SACEC,IADF,EAEEC,SAFF,EAGEC,WAHF,EAIEC,UAJF,EAKEC,cALF,EAMEC,WANF,EAOEC,MAPF,EAQEC,QARF,EASEC,IATF,QAUO,mBAVP;AAYA,OAAOC,OAAP,MAAoB,0BAApB;AACA,SAASC,GAAT,QAAoB,gBAApB;AAGA,OAAOC,IAAP,MAAiB,WAAjB;AACA,SAASC,SAAT,QAA0B,aAA1B;AACA,OAAOC,UAAP,MAAuB,6BAAvB;AACA,OAAOC,cAAP,MAA2B,iCAA3B;AACA,OAAOC,QAAP,MAAqB,2BAArB;AACA,OAAOC,GAAP,MAAgB,uBAAhB;AAEA,SAASC,YAAT,QAA6B,gBAA7B;AACA,SAASC,OAAT,QAAwB,iBAAxB;AACA,OAAOC,MAAP,IAAiBC,MAAjB,EAAyBC,OAAzB,QAAwC,KAAxC;AACA,MAAMC,OAAO,GAAG,IAAIL,YAAJ,EAAhB,C,CACA;;AACA,OAAOM,MAAP,MAAmB,aAAnB;AACA,SAASC,KAAT,QAAsB,mBAAtB;AACA,MAAMC,IAAI,GAAG,GAAb;;AAEA,MAAMC,KAAK,GAAIC,IAAD,IAAU,IAAIC,OAAJ,CAAaC,GAAD,IAASC,UAAU,CAACD,GAAD,EAAMF,IAAN,CAA/B,CAAxB;;AACA,MAAMI,GAAG,GAAG,mCAAZ;;AACA,MAAMC,OAAO,GAAG,CAACC,KAAD,EAAaC,IAAb,EAA2BT,IAA3B,KACdP,OAAO,CAACa,GAAD,EAAME,KAAN,EAAa;AAAEC,EAAAA,IAAF;AAAQT,EAAAA;AAAR,CAAb,CADT;;AAGA,MAAMU,YAAY,GAAGzB,GAAI;;;;;;;CAAzB;AASA,MAAM0B,aAAa;AAAG;AAAe;;;;;;;CAArC;AASA;;AACA,MAAMC,cAAc;AAAG;AAAe;;;;;;;CAAtC;AASA;;AACA,MAAMC,eAAe;AAAG;AAAe;;;;;;;CAAvC;AAeA,eAAe,SAASC,QAAT,CAAkB;AAAEL,EAAAA,IAAF;AAAQM,EAAAA,QAAR;AAAkBC,EAAAA;AAAlB,CAAlB,EAA8D;AAC3E,QAAMC,OAAO,GAAG3C,SAAS,EAAzB;AACA,QAAM;AAAE4C,IAAAA;AAAF,MAAWxB,MAAM,CAAC,CAACiB,aAAD,EAAgBF,IAAhB,EAAsBT,IAAtB,CAAD,EAA8B;AACnDmB,IAAAA,WAAW,EAAEJ;AADsC,GAA9B,CAAvB;AAGA,QAAMK,eAA0B,GAAGF,IAAI,IAAK,EAA5C;AACA,QAAMG,OAAgB,GAAG,CAACH,IAA1B,CAN2E,CAO3E;;AACAI,EAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ,EAA6BL,IAA7B;AAEA,QAAMM,MAAM,GAAGrC,SAAS,EAAxB;;AACA,MAAIqC,MAAM,CAACC,UAAP,IAAqBJ,OAAzB,EAAkC;AAChC,WAAO,MAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAP;AACD,GAb0E,CAe3E;;;AACA,QAAM;AAAA,OAACK,IAAD;AAAA,OAAOC;AAAP,MAAkBtD,QAAQ,CAAC,KAAD,CAAhC;;AAEA,QAAMuD,UAAU,GAAIC,CAAD,IAAY;AAC7BP,IAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BM,CAA5B;AACAA,IAAAA,CAAC,CAACC,cAAF;AACAD,IAAAA,CAAC,CAACE,eAAF;AACAJ,IAAAA,OAAO,CAAC,IAAD,CAAP;AACD,GALD;;AAOA,QAAMK,WAAW,GAAIH,CAAD,IAAY;AAC9BA,IAAAA,CAAC,CAACC,cAAF;AACAD,IAAAA,CAAC,CAACE,eAAF;AACAJ,IAAAA,OAAO,CAAC,KAAD,CAAP;AACD,GAJD;;AAMA,QAAMM,mBAAmB,GAAG,OAAOJ,CAAP,EAAUK,EAAV,KAAyB;AACnD,UAAMjC,KAAK,CAAC,IAAD,CAAX;AACAqB,IAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BM,CAA5B;AACAA,IAAAA,CAAC,CAACC,cAAF;AACAD,IAAAA,CAAC,CAACE,eAAF;AAEAT,IAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqB,OAAOW,EAA5B,EAAgCA,EAAhC;AACA,UAAMvC,MAAM,CAACW,GAAD,CAAZ;AAEA,UAAM6B,KAAK,GAAG,MAAM1C,OAAO,CAACa,GAAD,EAAMM,cAAN,EAAsB;AAACsB,MAAAA,EAAE,EAAEA;AAAL,KAAtB,CAA3B,CATmD,CAUnD;AACA;AACA;;AACAZ,IAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ,EAAkCY,KAAlC;AACA,UAAMvC,OAAO,CAACU,GAAD,CAAb;AACA,UAAMR,MAAM,CAACsC,IAAP,CAAa,WAAb,CAAN;AACD,GAhBD;;AAkBA,QAAMC,YAAY,GAAGC,MAAM,CAACC,IAAP,CAAYnB,eAAZ,EAA6BoB,GAA7B,CAClBC,CAAD,IAAOrB,eAAe,CAACqB,CAAD,CADH,EAEnB,CAFmB,CAArB;AAGA,QAAM;AAAA,OAACC,aAAD;AAAA,OAAgBC;AAAhB,MAAoCtE,QAAQ,CAAU,IAAV,CAAlD;AAEA,SACE;AAAK,IAAA,SAAS,EAAE4C,OAAO,CAAC2B,OAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEGlB,IAAI,IACH,MAAC,KAAD;AACE,IAAA,SAAS,EAAET,OAAO,CAAC4B,KADrB;AAEE,IAAA,IAAI,EAAEnB,IAFR;AAGE,IAAA,OAAO,EAAEM,WAHX;AAIE,IAAA,oBAAoB,MAJtB;AAKE,IAAA,iBAAiB,EAAElD,QALrB;AAME,IAAA,aAAa,EAAE;AACbgE,MAAAA,OAAO,EAAE;AADI,KANjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAUE,MAAC,IAAD;AAAM,IAAA,EAAE,EAAEpB,IAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAK,IAAA,SAAS,EAAET,OAAO,CAAC8B,KAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAI,IAAA,EAAE,EAAC,wBAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BADF,EAEE;AAAG,IAAA,EAAE,EAAC,8BAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yCAFF,EAKE,MAAC,MAAD;AACE,IAAA,IAAI,EAAC,OADP;AAEE,IAAA,OAAO,EAAC,WAFV;AAGE,IAAA,KAAK,EAAC,SAHR;AAIE,IAAA,OAAO,EAAE,MAAOlB,CAAP,IAAa;AACpB,YAAMI,mBAAmB,CAACJ,CAAD,EAAIa,aAAJ,aAAIA,aAAJ,uBAAIA,aAAa,CAAER,EAAnB,CAAzB;AACD,KANH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cALF,EAeE,MAAC,MAAD;AACE,IAAA,IAAI,EAAC,OADP;AAEE,IAAA,OAAO,EAAC,UAFV;AAGE,IAAA,KAAK,EAAC,SAHR;AAIE,IAAA,OAAO,EAAEF,WAJX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAfF,CADF,CAVF,CAHJ,EAyCE;AAAK,IAAA,SAAS,EAAEf,OAAO,CAAC+B,eAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,CAzCF,EA4CE,MAAC,GAAD;AAAK,IAAA,SAAS,EAAE/B,OAAO,CAACgC,mBAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGjC,WAAW,GAAG,CAAd,IAAmB,CAACQ,MAAM,CAACC,UAA3B,GACC,MAAC,UAAD;AACE,IAAA,IAAI,EAAEyB,QAAQ,CAAE1B,MAAM,CAAChB,KAAP,CAAa2C,IAAd,IAAiC,GAAlC,CADhB;AAEE,IAAA,KAAK,EAAEnC,WAFT;AAGE,IAAA,WAAW,EAAE,CAHf;AAIE,IAAA,UAAU,EAAGoC,IAAD,IACV,MAAC,cAAD;AACE,MAAA,SAAS,EAAEC,cADb;AAEE,MAAA,KAAK,EAAE7B,MAAM,CAAChB,KAFhB;AAGE,MAAA,IAAI,EAAE4C;AAHR,OAIMA,IAJN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OALJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADD,GAeC,MAAC,QAAD;AAAU,IAAA,OAAO,EAAC,MAAlB;AAAyB,IAAA,KAAK,EAAE,MAAhC;AAAwC,IAAA,MAAM,EAAE,MAAhD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAhBJ,CA5CF,EA+DE;AAAK,IAAA,SAAS,EAAEnC,OAAO,CAACqC,cAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACIvC,QAAQ,IAAIA,QAAQ,CAACwC,MAAT,GAAkB,CAA/B,IAAqC,CAAC/B,MAAM,CAACC,UAA7C,GACCY,YADD,aACCA,YADD,uBACCA,YAAY,CAAEG,GAAd,CAAkB,CAACgB,CAAD,EAAIC,CAAJ,KAAU;AAC1B,WACE,MAAC,IAAD;AACE,MAAA,IAAI,EAAC,wBADP;AAEE,MAAA,EAAE,EAAG,qBAAoBD,CAAC,CAACtB,EAAG,EAFhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAIE,MAAC,IAAD;AAAM,MAAA,GAAG,EAAEuB,CAAX;AAAc,MAAA,SAAS,EAAExC,OAAO,CAACyC,aAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,cAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,SAAD;AACE,MAAA,SAAS,EAAEzC,OAAO,CAAC0C,WADrB;AAEE,MAAA,KAAK,EAAC,6DAFR;AAGE,MAAA,KAAK,EAAC,uBAHR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,EAME,MAAC,WAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,UAAD;AAAY,MAAA,YAAY,MAAxB;AAAyB,MAAA,OAAO,EAAC,IAAjC;AAAsC,MAAA,SAAS,EAAC,IAAhD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACGH,CADH,aACGA,CADH,uBACGA,CAAC,CAAEI,IADN,CADF,EAIE,MAAC,UAAD;AACE,MAAA,OAAO,EAAC,OADV;AAEE,MAAA,KAAK,EAAC,eAFR;AAGE,MAAA,SAAS,EAAC,GAHZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kRAJF,EAgBE,MAAC,UAAD;AAAY,MAAA,SAAS,EAAE3C,OAAO,CAAC4C,WAA/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAhBF,CANF,CADF,EA4BE,MAAC,WAAD;AAAa,MAAA,SAAS,EAAE5C,OAAO,CAAC6C,aAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,GAAD;AAAK,MAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,MAAD;AACE,MAAA,IAAI,EAAC,OADP;AAEE,MAAA,KAAK,EAAC,SAFR;AAGE,MAAA,SAAS,EAAE7C,OAAO,CAAC8C,iBAHrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBADF,EAQE,MAAC,MAAD;AAAQ,MAAA,IAAI,EAAC,OAAb;AAAqB,MAAA,KAAK,EAAC,SAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBARF,CADF,EAcE,MAAC,MAAD;AACE,MAAA,IAAI,EAAC,OADP;AAEE,MAAA,KAAK,EAAC,SAFR;AAGE,MAAA,OAAO,EAAGlC,CAAD,IAAO;AACdD,QAAAA,UAAU,CAACC,CAAD,CAAV,CADc,CACA;;AACdc,QAAAA,gBAAgB,CAACa,CAAD,CAAhB;AACD,OANH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAdF,CA5BF,CAJF,CADF;AA6DD,GA9DD,CADD,GAiEC,MAAC,GAAD;AAAK,IAAA,SAAS,EAAEvC,OAAO,CAAC+C,iBAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,QAAD;AAAU,IAAA,OAAO,EAAC,MAAlB;AAAyB,IAAA,KAAK,EAAE,MAAhC;AAAwC,IAAA,MAAM,EAAE,OAAhD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEE;AAAK,IAAA,SAAS,EAAE/C,OAAO,CAACgD,gBAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAFF,CAlEJ,CA/DF,CADF;AA4ID;AAED,OAAO,MAAMC,cAA8B,GAAG,MAAOC,GAAP,IAAe;AAAA;;AAC3D,QAAMC,aAAa,GAAG,MAAMvE,OAAO,CAACwE,OAAR,CAAgBC,QAAhB,EAA5B;AACA,QAAMC,aAAa,GAAGjC,MAAM,CAACC,IAAP,CAAY6B,aAAZ,EAA2B5B,GAA3B,CACnBC,CAAD,IAAO2B,aAAa,CAAClB,QAAQ,CAACT,CAAD,CAAT,CADA,CAAtB;AAGA,QAAMzB,WAAW,GAAGwD,IAAI,CAACC,IAAL,CAClB,CAAE,CAAAF,aAAa,SAAb,IAAAA,aAAa,WAAb,YAAAA,aAAa,CAAEhB,MAAf,KAAyB,CAA3B,IAA2C,CAACvD,IAD1B,CAApB;AAGA,QAAM0E,SAAS,GAAI,CAAAP,GAAG,SAAH,IAAAA,GAAG,WAAH,2BAAAA,GAAG,CAAEQ,MAAL,4DAAaxB,IAAb,KAAqB,CAAxC;AAEA,QAAM1C,IAAI,GAAGmE,MAAM,CAAC,CAAC1B,QAAQ,CAACwB,SAAD,CAAR,GAAsB,CAAvB,IAA4B,CAAC1E,IAA9B,CAAnB,CAV2D,CAY3D;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAMe,QAAQ,GAAG,MAAMR,OAAO,CAACI,aAAD,EAAgBF,IAAhB,EAAsBT,IAAtB,CAA9B;AACAsB,EAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBR,QAAzB,EArB2D,CAsB3D;AACA;AACA;AACA;;AACA,SAAO;AACL8D,IAAAA,KAAK,EAAE;AACL9D,MAAAA,QADK;AAELC,MAAAA,WAFK;AAGLP,MAAAA;AAHK;AADF,GAAP;AAOD,CAjCM;AAmCP,OAAO,MAAMqE,cAAgD,GAAG,YAAY;AAC1E,SAAO;AACLC,IAAAA,KAAK,EAAE,CACL;AAAEJ,MAAAA,MAAM,EAAE;AAAExB,QAAAA,IAAI,EAAE;AAAR;AAAV,KADK,EAEL;AAAEwB,MAAAA,MAAM,EAAE;AAAExB,QAAAA,IAAI,EAAE;AAAR;AAAV,KAFK,EAGL;AAAEwB,MAAAA,MAAM,EAAE;AAAExB,QAAAA,IAAI,EAAE;AAAR;AAAV,KAHK,CADF;AAML6B,IAAAA,QAAQ,EAAE;AANL,GAAP;AAQD,CATM;AAgBP,OAAO,SAAS3B,cAAT,OAAwE;AAAA,MAAhD;AAAED,IAAAA,IAAF;AAAQ5C,IAAAA;AAAR,GAAgD;AAAA,MAA9BqE,KAA8B;;AAC7E,SACE,MAAC,IAAD;AAAM,IAAA,IAAI,EAAC,kBAAX;AAA8B,IAAA,EAAE,EAAG,aAAYzB,IAAI,CAACD,IAAK,EAAzD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,wBAAO0B,KAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KADF,CADF;AAKD","sourcesContent":["import React, { useState } from \"react\";\nimport useStyles from \"./style\";\nimport { PaginationRenderItemParams } from \"@material-ui/lab\";\nimport {\n  Card,\n  CardMedia,\n  CardContent,\n  Typography,\n  CardActionArea,\n  CardActions,\n  Button,\n  Backdrop,\n  Fade,\n} from \"@material-ui/core\";\nimport { GetStaticPaths, GetStaticProps } from \"next\";\nimport Loading from \"../../components/Loading\";\nimport { gql } from \"@apollo/client\";\nimport client from \"../apollo\";\nimport { Product } from \"../../interfaces\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport Pagination from \"@material-ui/lab/Pagination\";\nimport PaginationItem from \"@material-ui/lab/PaginationItem\";\nimport Skeleton from \"@material-ui/lab/Skeleton\";\nimport Box from \"@material-ui/core/Box\";\nimport { ParsedUrlQuery } from \"querystring\";\nimport { PrismaClient } from \"@prisma/client\";\nimport { request } from \"graphql-request\";\nimport useSWR, { mutate, trigger } from \"swr\";\nconst prisma2 = new PrismaClient();\n// import Modal from '../../components/Modal';\nimport Router from \"next/router\";\nimport { Modal } from \"@material-ui/core\";\nconst take = \"3\";\n\nconst sleep = (time) => new Promise((acc) => setTimeout(acc, time));\nconst API = \"http://localhost:3000/api/graphql\";\nconst fetcher = (query: any, skip: string, take: string) =>\n  request(API, query, { skip, take });\n\nconst ALL_PRODUCTS = gql`\n    query allProducts($skip: String!, $take: String!) {\n        allProducts(skip: $skip, take: $take) {\n            id\n            name\n        }\n    }\n`;\n\nconst ALL_PRODUCTS2 = /* GraphQL */ `\n  query allProducts($skip: String!, $take: String!) {\n    allProducts(skip: $skip, take: $take) {\n      id\n      name\n    }\n  }\n`;\n\n/* GraphQL */\nconst REMOVE_PRODUCT = /* GraphQL */ `\n  mutation removeProductById($id: String!) {\n    removeProductById(id: $id) {\n      id\n      name\n    }\n  }\n`;\n\n/* GraphQL */\nconst CREATE_PRODUCT2 = /* GraphQL */ `\n  mutation createNewOneProduct($name: String!) {\n    createNewOneProduct(name: $name) {\n      id\n      name\n    }\n  }\n`;\n\nexport interface IProducts {\n  products: Product[];\n  numberPages: number;\n  skip: string;\n}\n\nexport default function Products({ skip, products, numberPages }: IProducts) {\n  const classes = useStyles();\n  const { data } = useSWR([ALL_PRODUCTS2, skip, take], {\n    initialData: products,\n  });\n  const updatedProducts: Product[] = data! || [];\n  const loading: boolean = !data;\n  // console.log('products1', products)\n  console.log(\"data......---\", data);\n\n  const router = useRouter();\n  if (router.isFallback || loading) {\n    return <Loading />;\n  }\n\n  //modal function\n  const [open, setOpen] = useState(false);\n\n  const handleOpen = (e: any) => {\n    console.log(\"event delete\", e);\n    e.preventDefault();\n    e.stopPropagation();\n    setOpen(true);\n  };\n\n  const handleClose = (e: any) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setOpen(false);\n  };\n\n  const handleRemoveInModal = async (e, id: string) => {\n    await sleep(2000);\n    console.log(\"event remove\", e);\n    e.preventDefault();\n    e.stopPropagation();\n\n    console.log(\"id...\", typeof id, id);\n    await mutate(API);\n\n    const data1 = await request(API, REMOVE_PRODUCT, {id: id!})\n    // const { createNewOneProduct } = await request(API, CREATE_PRODUCT2, {\n    //   name: id,\n    // });\n    console.log(\"data check.....-> \", data1);\n    await trigger(API);\n    await Router.push(`/products`);\n  };\n\n  const productArray = Object.keys(updatedProducts).map(\n    (k) => updatedProducts[k]\n  )[0];\n  const [activeProduct, setActiveProduct] = useState<Product>(null);\n\n  return (\n    <div className={classes.wrapper}>\n      {/* Break component ===>  */}\n      {open && (\n        <Modal\n          className={classes.modal}\n          open={open}\n          onClose={handleClose}\n          closeAfterTransition\n          BackdropComponent={Backdrop}\n          BackdropProps={{\n            timeout: 500,\n          }}\n        >\n          <Fade in={open}>\n            <div className={classes.paper}>\n              <h2 id=\"transition-modal-title\">DELETE THIS PRODUCT</h2>\n              <p id=\"transition-modal-description\">\n                Do you want to delete this item?.\n              </p>\n              <Button\n                size=\"small\"\n                variant=\"contained\"\n                color=\"primary\"\n                onClick={async (e) => {\n                  await handleRemoveInModal(e, activeProduct?.id);\n                }}\n              >\n                REMOVE\n              </Button>\n              <Button\n                size=\"small\"\n                variant=\"outlined\"\n                color=\"default\"\n                onClick={handleClose}\n              >\n                CANCEL\n              </Button>\n            </div>\n          </Fade>\n        </Modal>\n      )}\n      <div className={classes.content__tittle}>\n        <div>POPULAR PRODUCTS</div>\n      </div>\n      <Box className={classes.content__pagination}>\n        {numberPages > 0 || !router.isFallback ? (\n          <Pagination\n            page={parseInt((router.query.page as string) || \"1\")}\n            count={numberPages}\n            defaultPage={1}\n            renderItem={(item) => (\n              <PaginationItem\n                component={MaterialUiLink}\n                query={router.query}\n                item={item}\n                {...item}\n              />\n            )}\n          />\n        ) : (\n          <Skeleton variant=\"rect\" width={\"30vw\"} height={\"28px\"} />\n        )}\n      </Box>\n      <div className={classes.content__items}>\n        {(products && products.length > 0) || !router.isFallback ? (\n          productArray?.map((p, i) => {\n            return (\n              <Link\n                href=\"/products/details/[id]\"\n                as={`/products/details/${p.id}`}\n              >\n                <Card key={i} className={classes.content__item}>\n                  <CardActionArea>\n                    <CardMedia\n                      className={classes.item__media}\n                      image=\"https://cdn.bike24.net/i/mb/d8/fa/b2/277893-00-d-557791.jpg\"\n                      title=\"Contemplative Reptile\"\n                    />\n                    <CardContent>\n                      <Typography gutterBottom variant=\"h5\" component=\"h2\">\n                        {p?.name}\n                      </Typography>\n                      <Typography\n                        variant=\"body2\"\n                        color=\"textSecondary\"\n                        component=\"p\"\n                      >\n                        Maximum impact cushioning. The brutal, repetitive,\n                        downward force of sport can wreak havoc on the body and\n                        on performance. Max Air cushioning is specifically\n                        engineered to handle these impacts and provide\n                        protection. Max Air is big air designed to take a\n                        pounding.\n                      </Typography>\n                      <Typography className={classes.item__price}>\n                        PRICE: 60.0 Euro\n                      </Typography>\n                    </CardContent>\n                  </CardActionArea>\n                  <CardActions className={classes.item__buttons}>\n                    <Box component=\"div\">\n                      <Button\n                        size=\"small\"\n                        color=\"primary\"\n                        className={classes.button__addToCart}\n                      >\n                        Add To Cart\n                      </Button>\n                      <Button size=\"small\" color=\"primary\">\n                        Learn More\n                      </Button>\n                    </Box>\n                    {/* Set active product ===> nhu */}\n                    <Button\n                      size=\"small\"\n                      color=\"primary\"\n                      onClick={(e) => {\n                        handleOpen(e);// Active product. ...\n                        setActiveProduct(p);\n                      }}\n                    >\n                      Delete\n                    </Button>\n                  </CardActions>\n                </Card>\n              </Link>\n            );\n          })\n        ) : (\n          <Box className={classes.content__skeleton}>\n            <Skeleton variant=\"rect\" width={\"28vw\"} height={\"720px\"} />\n            <div className={classes.wrapper__loading}>\n              <Loading />\n            </div>\n          </Box>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport const getStaticProps: GetStaticProps = async (ctx) => {\n  const totalProducts = await prisma2.product.findMany();\n  const productsArray = Object.keys(totalProducts).map(\n    (k) => totalProducts[parseInt(k)]\n  );\n  const numberPages = Math.ceil(\n    ((productsArray?.length || 0) as number) / +take\n  ) as number;\n  const pageQuery = (ctx?.params?.page || 1) as string;\n\n  const skip = String((parseInt(pageQuery) - 1) * +take);\n\n  // const {  data } = await client.query({\n  //   query: ALL_PRODUCTS,\n  //   variables: {\n  //     skip: skip,\n  //     take: take\n  //   }\n  // })\n\n  const products = await fetcher(ALL_PRODUCTS2, skip, take);\n  console.log(\"products2\", products);\n  // const products = Object.keys(data).map((k) => data[k])[0]\n  // console.log(' server build...', data)\n  //   const deleteItem = await fetcher(REMOVE_PRODUCT_BY_ID, skip, take);\n  // console.log('deleteItem:', deleteItem);\n  return {\n    props: {\n      products,\n      numberPages,\n      skip,\n    },\n  };\n};\n\nexport const getStaticPaths: GetStaticPaths<{ page: string }> = async () => {\n  return {\n    paths: [\n      { params: { page: \"1\" } },\n      { params: { page: \"2\" } },\n      { params: { page: \"3\" } },\n    ],\n    fallback: true,\n  };\n};\n\nexport interface MaterialUiLinkProps {\n  item: PaginationRenderItemParams;\n  query: ParsedUrlQuery;\n}\n\nexport function MaterialUiLink({ item, query, ...props }: MaterialUiLinkProps) {\n  return (\n    <Link href=\"/products/[page]\" as={`/products/${item.page}`}>\n      <a {...props}></a>\n    </Link>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}