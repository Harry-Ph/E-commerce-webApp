{"ast":null,"code":"var _jsxFileName = \"/Users/phan/Desktop/Integrify/fullstack-graphql-next-nexus-prisma/components/Modal/index.tsx\";\nvar __jsx = React.createElement;\nimport React, { useState } from 'react';\nimport { Modal, Backdrop, Fade, Button, CircularProgress, Box, FormGroup, TextField } from '@material-ui/core';\nimport { request } from \"graphql-request\";\nimport { mutate, trigger } from 'swr';\nimport useStyles from './style';\nimport { ErrorMessage, Field, Form, Formik } from \"formik\";\nimport { object, string } from \"yup\";\n\nconst sleep = time => new Promise(acc => setTimeout(acc, time));\n/* GraphQL */\n\n\nconst REMOVE_PRODUCT =\n/* GraphQL */\n`\n    mutation removeProductById($id: String!) {\n        removeProductById(id: $id) {\n            id\n            name\n        }\n    }\n`;\nconst API = 'http://localhost:3000/api/graphql';\nconst initialValues = {\n  name: ''\n}; // @ts-ignore\n\nexport default function TransitionsModal({\n  products,\n  redirectRouting,\n  currentPage,\n  handleOpen,\n  product,\n  handleClose,\n  open,\n  isEdit\n}) {\n  const classes = useStyles();\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState(false);\n\n  const handleRemoveInModal = async e => {\n    e.preventDefault();\n    e.stopPropagation();\n    await setIsLoading(true);\n    await sleep(2000);\n    const {\n      id\n    } = product;\n    console.log('products', products);\n    await mutate(API, [...(products === null || products === void 0 ? void 0 : products.filter(p => (p === null || p === void 0 ? void 0 : p.id) != id))], false);\n    await request(API, REMOVE_PRODUCT, {\n      id\n    }); // await  mutate(API, async () => {\n    //   const {allProducts} = await fetcher(ALL_PRODUCTS2, skip as string, take as string);\n    //   return [...allProducts?.filter(p => p?.id != id)];\n    // })\n\n    await trigger(API);\n    await handleClose(e); // await redirectRouting(String(currentPage))\n    // await Router.replace(`/products/${currentPage}`,  `/products/${currentPage}`, {shallow: true})\n  };\n\n  return __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 9\n    }\n  }, __jsx(Modal, {\n    className: classes.modal,\n    open: open,\n    onClose: handleClose,\n    closeAfterTransition: true,\n    BackdropComponent: Backdrop,\n    BackdropProps: {\n      timeout: 500\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }\n  }, __jsx(Fade, {\n    in: open,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 17\n    }\n  }, __jsx(\"div\", {\n    className: classes.paper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 21\n    }\n  }, __jsx(\"h2\", {\n    id: \"transition-modal-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 25\n    }\n  }, isEdit ? 'EDIT' : 'DELETE', \" THIS PRODUCT\"), __jsx(\"p\", {\n    id: \"transition-modal-description\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 25\n    }\n  }, \"Do you want to \", isEdit ? 'edit' : 'delete', \" this item?.\"), isEdit ? __jsx(Formik, {\n    validationSchema: object({\n      name: string().required().min(2).max(50)\n    }),\n    initialValues: initialValues,\n    onSubmit: () => {},\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 29\n    }\n  }, ({\n    isSubmitting\n  }) => __jsx(Form, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 37\n    }\n  }, __jsx(Box, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 41\n    }\n  }, __jsx(FormGroup, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 45\n    }\n  }, __jsx(Field, {\n    name: \"name\",\n    as: TextField,\n    label: \"Name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 49\n    }\n  }), __jsx(ErrorMessage, {\n    name: \"name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 49\n    }\n  }))), __jsx(Button, {\n    size: \"small\",\n    variant: \"contained\",\n    color: \"primary\",\n    type: \"submit\",\n    disabled: isSubmitting,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 41\n    }\n  }, \"SUBMIT\"), __jsx(Button, {\n    size: \"small\",\n    variant: \"outlined\",\n    color: \"default\",\n    type: \"submit\",\n    onClick: handleClose,\n    disabled: isLoading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 41\n    }\n  }, \"CANCEL\"))) : __jsx(React.Fragment, null, __jsx(Button, {\n    size: \"small\",\n    variant: \"contained\",\n    color: \"primary\",\n    onClick: handleRemoveInModal,\n    startIcon: isLoading ? __jsx(CircularProgress, {\n      size: \"1rem\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 60\n      }\n    }) : null,\n    disabled: isLoading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 33\n    }\n  }, \"REMOVE\"), __jsx(Button, {\n    size: \"small\",\n    variant: \"outlined\",\n    color: \"default\",\n    type: \"submit\",\n    onClick: handleClose,\n    disabled: isLoading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 33\n    }\n  }, \"CANCEL\"))))));\n}","map":{"version":3,"sources":["/Users/phan/Desktop/Integrify/fullstack-graphql-next-nexus-prisma/components/Modal/index.tsx"],"names":["React","useState","Modal","Backdrop","Fade","Button","CircularProgress","Box","FormGroup","TextField","request","mutate","trigger","useStyles","ErrorMessage","Field","Form","Formik","object","string","sleep","time","Promise","acc","setTimeout","REMOVE_PRODUCT","API","initialValues","name","TransitionsModal","products","redirectRouting","currentPage","handleOpen","product","handleClose","open","isEdit","classes","isLoading","setIsLoading","handleRemoveInModal","e","preventDefault","stopPropagation","id","console","log","filter","p","modal","timeout","paper","required","min","max","isSubmitting"],"mappings":"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","sourcesContent":["import React, {useState} from 'react';\nimport {Modal, Backdrop, Fade, Button, CircularProgress, Box, FormGroup, TextField} from '@material-ui/core';\n\nimport {request} from \"graphql-request\";\nimport  {mutate, trigger} from 'swr'\nimport useStyles from './style';\nimport {Product} from \"../../interfaces\";\nimport {ErrorMessage, Field, Form, Formik} from \"formik\";\n\nimport {object, string} from \"yup\";\n\nconst sleep = (time: any) => new Promise((acc: any) => setTimeout(acc, time));\n\n/* GraphQL */\nconst REMOVE_PRODUCT = /* GraphQL */`\n    mutation removeProductById($id: String!) {\n        removeProductById(id: $id) {\n            id\n            name\n        }\n    }\n`\n\nconst API = 'http://localhost:3000/api/graphql'\n\nexport interface IModel {\n  currentPage: any\n  handleOpen: (e: any)=> void\n  product: Product\n  handleClose: (e: any)=> void\n  redirectRouting:  (currentPage: string)=> void\n  open: boolean\n  isEdit: boolean\n  products: Product[]\n}\n\nconst initialValues = {\n    name: '',\n}\n\n// @ts-ignore\nexport default function TransitionsModal({products , redirectRouting, currentPage, handleOpen, product, handleClose, open, isEdit}: IModel) {\n    const classes = useStyles();\n    const [isLoading, setIsLoading] = useState(false);\n\n    const handleRemoveInModal = async (e: any) => {\n\n      e.preventDefault();\n      e.stopPropagation();\n\n      await setIsLoading(true)\n\n      await sleep(2000);\n      const {id} = product;\n      console.log('products', products)\n\n      await mutate(API, [...products?.filter(p => p?.id != id)], false);\n\n      await request(API, REMOVE_PRODUCT, {id})\n\n      // await  mutate(API, async () => {\n      //   const {allProducts} = await fetcher(ALL_PRODUCTS2, skip as string, take as string);\n      //   return [...allProducts?.filter(p => p?.id != id)];\n      // })\n\n      await trigger(API);\n\n\n\n      await handleClose(e);\n\n      // await redirectRouting(String(currentPage))\n      // await Router.replace(`/products/${currentPage}`,  `/products/${currentPage}`, {shallow: true})\n    }\n\n    return (\n        <div>\n            <Modal\n                className={classes.modal}\n                open={open}\n                onClose={handleClose}\n                closeAfterTransition\n                BackdropComponent={Backdrop}\n                BackdropProps={{\n                    timeout: 500,\n                }}\n            >\n                <Fade in={open}>\n                    <div className={classes.paper}>\n                        <h2 id=\"transition-modal-title\">{isEdit ? 'EDIT' : 'DELETE'} THIS PRODUCT</h2>\n                        <p id=\"transition-modal-description\">Do you want to {isEdit ? 'edit' : 'delete'} this item?.</p>\n                        {isEdit ?\n                            <Formik\n                                validationSchema={\n                                    object({\n                                        name: string().required().min(2).max(50),\n                                    })\n                                }\n                                initialValues={initialValues}\n                                onSubmit={() => {}}>\n                                {({isSubmitting}) => (\n                                    <Form>\n                                        <Box>\n                                            <FormGroup>\n                                                <Field name=\"name\" as={TextField} label=\"Name\"/>\n                                                <ErrorMessage name=\"name\" />\n                                            </FormGroup>\n                                        </Box>\n                                        <Button size=\"small\"\n                                                variant=\"contained\"\n                                                color=\"primary\"\n                                                type=\"submit\" disabled={isSubmitting}>SUBMIT</Button>\n                                        <Button\n                                            size=\"small\"\n                                            variant=\"outlined\"\n                                            color=\"default\"\n                                            type=\"submit\"\n                                            onClick={handleClose}\n                                            disabled={isLoading}\n                                        >CANCEL</Button>\n                                    </Form>\n                                )}\n                            </Formik>\n                            :\n                            <>\n                                <Button\n                                    size=\"small\"\n                                    variant=\"contained\"\n                                    color=\"primary\"\n                                    onClick={handleRemoveInModal}\n                                    startIcon={isLoading ? <CircularProgress size=\"1rem\" /> : null}\n                                    disabled={isLoading}\n                                >REMOVE</Button>\n                                <Button\n                                    size=\"small\"\n                                    variant=\"outlined\"\n                                    color=\"default\"\n                                    type=\"submit\"\n                                    onClick={handleClose}\n                                    disabled={isLoading}\n                                >CANCEL</Button>\n                            </>\n                        }\n                    </div>\n                </Fade>\n            </Modal>\n        </div>\n    );\n}\n"]},"metadata":{},"sourceType":"module"}