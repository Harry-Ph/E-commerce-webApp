{"ast":null,"code":"var _jsxFileName = \"/Users/phan/Desktop/Integrify/fullstack-graphql-next-nexus-prisma/pages/products/index.tsx\";\nvar __jsx = React.createElement;\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from 'react';\nimport useStyles from './style';\nimport { Card, CardMedia, CardContent, Typography, CardActionArea, CardActions, Button } from '@material-ui/core';\nimport Loading from \"../../components/Loading\";\nimport { gql } from \"@apollo/client\";\nimport client from \"../apollo\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport Pagination from '@material-ui/lab/Pagination';\nimport PaginationItem from '@material-ui/lab/PaginationItem';\nimport { PrismaClient } from \"@prisma/client\";\nimport Skeleton from \"@material-ui/lab/Skeleton\";\nimport Box from \"@material-ui/core/Box\";\nconst prisma2 = new PrismaClient();\nconst take = '3';\nconst ALL_PRODUCTS = gql`\n    query allProducts($skip: String!, $take: String!) {\n        allProducts(skip: $skip, take: $take) {\n            id\n            name\n        }\n    }\n`;\nexport default function Products({\n  products,\n  numberPages,\n  networkStatus\n}) {\n  const classes = useStyles(); // const [a, setA] = useState(0);\n  // const b =() => {\n  //   if(a !== 1) {\n  //     const c = () => {\n  //       setA(1);\n  //     }\n  //     setTimeout(c, 5000);\n  //   }\n  // }\n  // b();\n\n  console.log('component render ...');\n  const router = useRouter();\n\n  if (router.isFallback || !products) {\n    return __jsx(Loading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 12\n      }\n    });\n  } // const { loading, error, data, refetch, networkStatus } = useQuery(\n  //   GET_DOG_PHOTO,\n  //   {\n  //     variables: { breed },\n  //     notifyOnNetworkStatusChange: true,\n  //   },\n  // );\n  // if(networkStatus === NetworkStatus.refetch) {\n  //   return <Loading/>\n  // }\n\n\n  return __jsx(\"div\", {\n    className: classes.wrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    className: classes.content__tittle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 9\n    }\n  }, \"POPULAR PRODUCTS\")), __jsx(Box, {\n    className: classes.content__pagination,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }\n  }, numberPages > 0 || !router.isFallback ? __jsx(Pagination, {\n    page: parseInt(router.query.page || '1'),\n    count: numberPages,\n    defaultPage: 1,\n    renderItem: item => __jsx(PaginationItem, _extends({\n      component: MaterialUiLink,\n      query: router.query,\n      item: item\n    }, item, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 17\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 54\n    }\n  }) : __jsx(Skeleton, {\n    variant: \"rect\",\n    width: '30vw',\n    height: '28px',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }\n  })), __jsx(\"div\", {\n    className: classes.content__items,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }\n  }, products && products.length > 0 || !router.isFallback ? products === null || products === void 0 ? void 0 : products.map(p => __jsx(Link, {\n    href: \"/products/details/[id]\",\n    as: `/products/details/${p.id}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 15\n    }\n  }, __jsx(Card, {\n    className: classes.content__item,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 17\n    }\n  }, __jsx(CardActionArea, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 19\n    }\n  }, __jsx(CardMedia, {\n    className: classes.item__media,\n    image: \"https://cdn.bike24.net/i/mb/d8/fa/b2/277893-00-d-557791.jpg\",\n    title: \"Contemplative Reptile\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 21\n    }\n  }), __jsx(CardContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 21\n    }\n  }, __jsx(Typography, {\n    gutterBottom: true,\n    variant: \"h5\",\n    component: \"h2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 23\n    }\n  }, p === null || p === void 0 ? void 0 : p.name), __jsx(Typography, {\n    variant: \"body2\",\n    color: \"textSecondary\",\n    component: \"p\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 23\n    }\n  }, \"Maximum impact cushioning. The brutal, repetitive, downward force of sport can wreak havoc on the body and on performance. Max Air cushioning is specifically engineered to handle these impacts and provide protection. Max Air is big air designed to take a pounding.\"), __jsx(Typography, {\n    className: classes.item__price,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 23\n    }\n  }, \"PRICE: 60.0 Euro\"))), __jsx(CardActions, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 19\n    }\n  }, __jsx(Button, {\n    size: \"small\",\n    color: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 21\n    }\n  }, \"Add To Cart\"), __jsx(Button, {\n    size: \"small\",\n    color: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 21\n    }\n  }, \"Learn More\"))))) : __jsx(Box, {\n    className: classes.content__skeleton,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 13\n    }\n  }, __jsx(Skeleton, {\n    variant: \"rect\",\n    width: '28vw',\n    height: '600px',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 15\n    }\n  }), __jsx(\"div\", {\n    className: classes.wrapper__loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 15\n    }\n  }, __jsx(Loading, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 17\n    }\n  })))));\n}\nexport const getStaticProps = async ctx => {\n  const localCache = client.readQuery({\n    query: ALL_PRODUCTS,\n    variables: {\n      skip: '0',\n      take: take\n    }\n  });\n\n  if (localCache) {\n    return {\n      props: {\n        products,\n        numberPages,\n        networkStatus\n      }\n    };\n  }\n\n  const totalProducts = await prisma2.product.findMany();\n  const productsArray = Object.keys(totalProducts).map(k => totalProducts[k]);\n  const numberPages = Math.ceil(((productsArray === null || productsArray === void 0 ? void 0 : productsArray.length) || 0) / +take);\n  const {\n    loading,\n    error,\n    data,\n    networkStatus\n  } = await client.query({\n    query: ALL_PRODUCTS,\n    variables: {\n      skip: '0',\n      take: take\n    }\n  });\n  console.log('static props ...');\n  const products = Object.keys(data).map(k => data[k])[0];\n\n  if (data) {\n    client.writeQuery({\n      query,\n      data: {\n        products\n      }\n    });\n  }\n\n  return {\n    props: {\n      products,\n      numberPages,\n      networkStatus\n    }\n  };\n};\nexport function MaterialUiLink(_ref) {\n  let {\n    item,\n    query\n  } = _ref,\n      props = _objectWithoutProperties(_ref, [\"item\", \"query\"]);\n\n  return __jsx(Link, {\n    href: \"/products/[page]\",\n    as: `/products/${item.page}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 5\n    }\n  }, __jsx(\"a\", _extends({}, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 7\n    }\n  })));\n}","map":{"version":3,"sources":["/Users/phan/Desktop/Integrify/fullstack-graphql-next-nexus-prisma/pages/products/index.tsx"],"names":["React","useStyles","Card","CardMedia","CardContent","Typography","CardActionArea","CardActions","Button","Loading","gql","client","Link","useRouter","Pagination","PaginationItem","PrismaClient","Skeleton","Box","prisma2","take","ALL_PRODUCTS","Products","products","numberPages","networkStatus","classes","console","log","router","isFallback","wrapper","content__tittle","content__pagination","parseInt","query","page","item","MaterialUiLink","content__items","length","map","p","id","content__item","item__media","name","item__price","content__skeleton","wrapper__loading","getStaticProps","ctx","localCache","readQuery","variables","skip","props","totalProducts","product","findMany","productsArray","Object","keys","k","Math","ceil","loading","error","data","writeQuery"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react'\nimport useStyles from './style'\nimport { PaginationRenderItemParams } from '@material-ui/lab';\nimport { Card, CardMedia, CardContent, Typography, CardActionArea, CardActions, Button } from '@material-ui/core'\nimport {GetStaticPaths, GetStaticProps} from \"next\";\nimport Loading from \"../../components/Loading\";\nimport {gql, NetworkStatus} from \"@apollo/client\";\nimport client from \"../apollo\";\nimport {Product} from \"../../interfaces\";\nimport Link from \"next/link\";\nimport {useRouter} from \"next/router\";\nimport Pagination from '@material-ui/lab/Pagination';\nimport PaginationItem from '@material-ui/lab/PaginationItem';\nimport { ParsedUrlQuery } from 'querystring';\nimport { PrismaClient } from \"@prisma/client\"\nimport Skeleton from \"@material-ui/lab/Skeleton\";\nimport Box from \"@material-ui/core/Box\";\nconst prisma2 = new PrismaClient()\n\nconst take = '3';\n\n\nconst ALL_PRODUCTS = gql`\n    query allProducts($skip: String!, $take: String!) {\n        allProducts(skip: $skip, take: $take) {\n            id\n            name\n        }\n    }\n`\n\nexport interface IProducts {\n  products: Product[]\n  numberPages: number,\n  networkStatus: any\n}\n\nexport default function Products({products, numberPages, networkStatus}: IProducts) {\n  const classes = useStyles();\n\n  // const [a, setA] = useState(0);\n  // const b =() => {\n  //   if(a !== 1) {\n  //     const c = () => {\n  //       setA(1);\n  //     }\n  //     setTimeout(c, 5000);\n  //   }\n  // }\n  // b();\n  console.log('component render ...')\n  const router = useRouter();\n  if( router.isFallback || !products) {\n    return <Loading/>\n  }\n\n  // const { loading, error, data, refetch, networkStatus } = useQuery(\n  //   GET_DOG_PHOTO,\n  //   {\n  //     variables: { breed },\n  //     notifyOnNetworkStatusChange: true,\n  //   },\n  // );\n\n  // if(networkStatus === NetworkStatus.refetch) {\n  //   return <Loading/>\n  // }\n\n  return (\n    <div className={classes.wrapper}>\n      <div className={classes.content__tittle}>\n        <div>POPULAR PRODUCTS</div>\n      </div>\n      <Box className={classes.content__pagination}>\n        {\n          (numberPages > 0 || !router.isFallback) ? (<Pagination\n              page={parseInt(router.query.page as string || '1')}\n              count={numberPages}\n              defaultPage={1}\n              renderItem={(item) => (\n                <PaginationItem\n                  component={MaterialUiLink}\n                  query={router.query}\n                  item={item}\n                  {...item}\n                />\n              )}\n            />) :\n            <Skeleton variant=\"rect\" width={'30vw'} height={'28px'} />\n        }\n      </Box>\n      <div className={classes.content__items}>\n        {\n          ((products && products.length > 0) || !router.isFallback) ?\n            (products?.map(p=> (\n              <Link href=\"/products/details/[id]\" as={`/products/details/${p.id}`}>\n                <Card className={classes.content__item}>\n                  <CardActionArea>\n                    <CardMedia className={classes.item__media}\n                               image=\"https://cdn.bike24.net/i/mb/d8/fa/b2/277893-00-d-557791.jpg\"\n                               title=\"Contemplative Reptile\"\n                    />\n                    <CardContent>\n                      <Typography gutterBottom variant=\"h5\" component=\"h2\">\n                        {p?.name}\n                      </Typography>\n                      <Typography variant=\"body2\" color=\"textSecondary\" component=\"p\">\n                        Maximum impact cushioning. The brutal, repetitive,\n                        downward force of sport can wreak havoc on the body and on performance.\n                        Max Air cushioning is specifically engineered to handle these impacts and provide protection.\n                        Max Air is big air designed to take a pounding.\n                      </Typography>\n                      <Typography className={classes.item__price} >PRICE: 60.0 Euro</Typography>\n                    </CardContent>\n                  </CardActionArea>\n                  <CardActions>\n                    <Button size=\"small\" color=\"primary\">\n                      Add To Cart\n                    </Button>\n                    <Button size=\"small\" color=\"primary\">\n                      Learn More\n                    </Button>\n                  </CardActions>\n                </Card>\n              </Link>\n\n            ))) :\n            <Box className={classes.content__skeleton}>\n              <Skeleton variant=\"rect\" width={'28vw'} height={'600px'} />\n              <div className={classes.wrapper__loading}>\n                <Loading />\n              </div>\n            </Box>\n        }\n      </div>\n    </div>\n  )\n}\n\nexport const getStaticProps:GetStaticProps = async (ctx) => {\n  const localCache = client.readQuery({\n    query: ALL_PRODUCTS,\n    variables: {\n      skip: '0',\n      take: take\n    },\n  } );\n  if (localCache) {\n    return {\n      props: {\n        products,\n        numberPages,\n        networkStatus\n      },\n    }\n  }\n\n  const totalProducts = await prisma2.product.findMany();\n  const productsArray = Object.keys(totalProducts).map((k) => totalProducts[k])\n  const numberPages = Math.ceil((productsArray?.length || 0) as number / +take) as number;\n\n  const {  loading, error, data, networkStatus } = await client.query({\n    query: ALL_PRODUCTS,\n    variables: {\n      skip: '0',\n      take: take\n    },\n  })\n\n  console.log('static props ...')\n  const products = Object.keys(data).map((k) => data[k])[0]\n\n  if (data) {\n    client.writeQuery({\n      query,\n      data: {\n        products\n      },\n    });\n  }\n\n\n  return {\n    props: {\n      products,\n      numberPages,\n      networkStatus\n    },\n  }\n}\n\nexport interface MaterialUiLinkProps {\n  item: PaginationRenderItemParams;\n  query: ParsedUrlQuery;\n}\n\nexport function MaterialUiLink({ item, query, ...props }: MaterialUiLinkProps) {\n  return (\n    <Link\n      href=\"/products/[page]\"\n      as={`/products/${item.page}`}\n    >\n      <a {...props}></a>\n    </Link>\n  );\n}"]},"metadata":{},"sourceType":"module"}