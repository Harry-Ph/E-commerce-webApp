{"ast":null,"code":"var _jsxFileName = \"/Users/phan/Desktop/Integrify/fullstack-graphql-next-nexus-prisma/pages/products/index.tsx\";\nvar __jsx = React.createElement;\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React, { useState } from \"react\";\nimport useStyles from \"./style\";\nimport { Card, CardMedia, CardContent, Typography, CardActionArea, CardActions, Button } from \"@material-ui/core\";\nimport Loading from \"../../components/Loading\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport Pagination from \"@material-ui/lab/Pagination\";\nimport PaginationItem from \"@material-ui/lab/PaginationItem\";\nimport Skeleton from \"@material-ui/lab/Skeleton\";\nimport Box from \"@material-ui/core/Box\";\nimport { PrismaClient } from \"@prisma/client\";\nimport { request } from \"graphql-request\";\nimport useSWR from \"swr\";\nconst prisma2 = new PrismaClient();\nimport CustomModal from '../../components/Modal';\nimport Router from \"next/router\";\nimport LazyLoad from 'react-lazyload';\nconst take = \"9\";\nconst API = \"http://localhost:3000/api/graphql\";\n\nconst fetcher = (query, skip, take) => request(API, query, {\n  skip,\n  take\n});\n\nconst ALL_PRODUCTS2 =\n/* GraphQL */\n`\n  query allProducts($skip: String!, $take: String!) {\n    allProducts(skip: $skip, take: $take) {\n      id\n      name\n    }\n  }\n`;\nexport default function Products({\n  skip,\n  products,\n  numberPages\n}) {\n  const classes = useStyles();\n  const {\n    0: open,\n    1: setOpen\n  } = useState(false);\n  const {\n    0: openEdit,\n    1: setOpenEdit\n  } = useState(false);\n  const {\n    0: activeProduct,\n    1: setActiveProduct\n  } = useState();\n  const {\n    data\n  } = useSWR([ALL_PRODUCTS2, skip, take], {\n    initialData: products\n  });\n  const loading = !data;\n  const router = useRouter();\n\n  if (router.isFallback || loading) {\n    return __jsx(Loading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 12\n      }\n    });\n  }\n\n  const handleOnclickDeleteBtn = async (product, e) => {\n    await handleOpen(e); // Active product. ...\n\n    await setActiveProduct(product);\n  };\n\n  const redirectRouting = async currentPage => {\n    await Router.replace(`/products/${currentPage}`, `/products/${currentPage}`, {\n      shallow: true\n    });\n  };\n\n  const handleOpen = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    setOpen(true);\n  };\n\n  const handleClose = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    setOpen(false);\n  };\n\n  const handleOpenOrCloseEdit = e => {\n    e.preventDefault();\n    setOpenEdit(!openEdit);\n  }; // @ts-ignore\n\n\n  let updatedProducts = null;\n  console.log('ahuchccheck..', updatedProducts);\n  const typeOfUpdateProducts = typeof data;\n\n  if (typeOfUpdateProducts === \"object\") {\n    // @ts-ignore\n    updatedProducts = data === null || data === void 0 ? void 0 : data.allProducts;\n  }\n\n  return __jsx(\"div\", {\n    className: classes.wrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 5\n    }\n  }, open && activeProduct && __jsx(CustomModal, {\n    handleOpen: handleOpen,\n    product: activeProduct,\n    handleClose: handleClose,\n    open: open,\n    redirectRouting: redirectRouting,\n    currentPage: router.query.page || 1,\n    isEdit: false // @ts-ignore\n    ,\n    products: productArray || products || [],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 26\n    }\n  }), openEdit ? __jsx(CustomModal, {\n    redirectRouting: redirectRouting,\n    product: activeProduct,\n    currentPage: router.query.page || 1,\n    handleClose: handleOpenOrCloseEdit,\n    handleOpen: handleOpenOrCloseEdit,\n    open: openEdit,\n    isEdit: true // @ts-ignore\n    ,\n    products: productArray || products || [],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 19\n    }\n  }) : null, __jsx(\"div\", {\n    className: classes.content__tittle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 9\n    }\n  }, \"POPULAR PRODUCTS\")), __jsx(Box, {\n    className: classes.content__pagination,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 7\n    }\n  }, numberPages > 0 || !router.isFallback ? __jsx(Pagination, {\n    page: parseInt(router.query.page || \"1\"),\n    count: numberPages,\n    defaultPage: 1,\n    renderItem: item => __jsx(PaginationItem, _extends({\n      component: MaterialUiLink,\n      query: router.query || 1,\n      item: item\n    }, item, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 15\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 11\n    }\n  }) : __jsx(Skeleton, {\n    variant: \"rect\",\n    width: \"30vw\",\n    height: \"28px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 11\n    }\n  })), __jsx(\"div\", {\n    className: classes.content__items,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 7\n    }\n  }, updatedProducts ? updatedProducts.map((p, i) => {\n    return __jsx(Box, {\n      className: classes.lazyLoading,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 15\n      }\n    }, __jsx(LazyLoad, {\n      key: p.id,\n      height: 9,\n      offset: [-9, 9],\n      placeholder: __jsx(Loading, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 32\n        }\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 17\n      }\n    }, __jsx(Link, {\n      href: \"/products/details/[id]\",\n      as: `/products/details/${p.id}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 19\n      }\n    }, __jsx(Card, {\n      key: i,\n      className: classes.content__item,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 21\n      }\n    }, __jsx(CardActionArea, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 23\n      }\n    }, __jsx(CardMedia, {\n      className: classes.item__media,\n      image: \"https://cdn.bike24.net/i/mb/d8/fa/b2/277893-00-d-557791.jpg\",\n      title: \"Contemplative Reptile\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 25\n      }\n    }), __jsx(CardContent, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 25\n      }\n    }, __jsx(Typography, {\n      gutterBottom: true,\n      variant: \"h5\",\n      component: \"h2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 27\n      }\n    }, p.name), __jsx(Typography, {\n      variant: \"body2\",\n      color: \"textSecondary\",\n      component: \"p\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 27\n      }\n    }, \"Maximum impact cushioning. The brutal, repetitive, downward force of sport can wreak havoc on the body and on performance. Max Air cushioning is specifically engineered to handle these impacts and provide protection. Max Air is big air designed to take a pounding.\"), __jsx(Typography, {\n      className: classes.item__price,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 27\n      }\n    }, \"PRICE: 60.0 Euro\"))), __jsx(CardActions, {\n      className: classes.item__buttons,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 23\n      }\n    }, __jsx(Box, {\n      component: \"div\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 25\n      }\n    }, __jsx(Button, {\n      size: \"small\",\n      color: \"primary\",\n      className: classes.button__addToCart,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 27\n      }\n    }, \"Add To Cart\"), __jsx(Button, {\n      size: \"small\",\n      color: \"primary\",\n      onClick: handleOpenOrCloseEdit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 27\n      }\n    }, \"EDIT\")), __jsx(Button, {\n      size: \"small\",\n      color: \"primary\",\n      onClick: e => handleOnclickDeleteBtn(p, e),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 25\n      }\n    }, \"Delete\"))))));\n  }) : __jsx(Box, {\n    className: classes.content__skeleton,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 11\n    }\n  }, __jsx(Skeleton, {\n    variant: \"rect\",\n    width: \"28vw\",\n    height: \"720px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 13\n    }\n  }), __jsx(\"div\", {\n    className: classes.wrapper__loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 13\n    }\n  }, __jsx(Loading, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 15\n    }\n  })))));\n}\nexport const getStaticProps = async ctx => {\n  var _ctx$params;\n\n  const totalProducts = await prisma2.product.findMany();\n  const productsArray = Object.keys(totalProducts).map(k => totalProducts[parseInt(k)]);\n  const numberPages = Math.ceil(((productsArray === null || productsArray === void 0 ? void 0 : productsArray.length) || 0) / +take);\n  const pageQuery = (ctx === null || ctx === void 0 ? void 0 : (_ctx$params = ctx.params) === null || _ctx$params === void 0 ? void 0 : _ctx$params.page) || 1;\n  const skip = String((parseInt(pageQuery) - 1) * +take);\n  const productsOfPage = await prisma2.product.findMany({\n    skip: +skip,\n    take: +take\n  }); // const productsArrayOfPage = Object.keys(productsOfPage).map(\n  //   (k) => productsOfPage[parseInt(k)]\n  // );\n  // const {  data } = await client.query({\n  //   query: ALL_PRODUCTS,\n  //   variables: {\n  //     skip: skip,\n  //     take: take\n  //   }\n  // })\n\n  const a = _objectSpread({}, productsOfPage);\n\n  const b = {\n    allProducts: [...a]\n  };\n  const products = await fetcher(ALL_PRODUCTS2, skip, take);\n  console.log('productsArrayOfPage', b);\n  console.log('products', products);\n  return {\n    props: {\n      products: productsOfPage,\n      numberPages,\n      skip\n    }\n  };\n};\nexport function MaterialUiLink(_ref) {\n  let {\n    item,\n    query\n  } = _ref,\n      props = _objectWithoutProperties(_ref, [\"item\", \"query\"]);\n\n  // const router = useRouter();\n  // if ( !router.query.page)\n  //   return (\n  //     <Link href=\"/products\" as={`/products`}>\n  //       <a {...props}></a>\n  //     </Link>\n  //   );\n  return __jsx(Link, {\n    href: \"/products/[page]\",\n    as: `/products/${item.page}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 5\n    }\n  }, __jsx(\"a\", _extends({}, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 7\n    }\n  })));\n}","map":{"version":3,"sources":["/Users/phan/Desktop/Integrify/fullstack-graphql-next-nexus-prisma/pages/products/index.tsx"],"names":["React","useState","useStyles","Card","CardMedia","CardContent","Typography","CardActionArea","CardActions","Button","Loading","Link","useRouter","Pagination","PaginationItem","Skeleton","Box","PrismaClient","request","useSWR","prisma2","CustomModal","Router","LazyLoad","take","API","fetcher","query","skip","ALL_PRODUCTS2","Products","products","numberPages","classes","open","setOpen","openEdit","setOpenEdit","activeProduct","setActiveProduct","data","initialData","loading","router","isFallback","handleOnclickDeleteBtn","product","e","handleOpen","redirectRouting","currentPage","replace","shallow","preventDefault","stopPropagation","handleClose","handleOpenOrCloseEdit","updatedProducts","console","log","typeOfUpdateProducts","allProducts","wrapper","page","productArray","content__tittle","content__pagination","parseInt","item","MaterialUiLink","content__items","map","p","i","lazyLoading","id","content__item","item__media","name","item__price","item__buttons","button__addToCart","content__skeleton","wrapper__loading","getStaticProps","ctx","totalProducts","findMany","productsArray","Object","keys","k","Math","ceil","length","pageQuery","params","String","productsOfPage","a","b","props"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport useStyles from \"./style\";\nimport { PaginationRenderItemParams } from \"@material-ui/lab\";\nimport {\n  Card,\n  CardMedia,\n  CardContent,\n  Typography,\n  CardActionArea,\n  CardActions,\n  Button,\n} from \"@material-ui/core\";\nimport { GetStaticProps } from \"next\";\nimport Loading from \"../../components/Loading\";\nimport { Product } from \"../../interfaces\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport Pagination from \"@material-ui/lab/Pagination\";\nimport PaginationItem from \"@material-ui/lab/PaginationItem\";\nimport Skeleton from \"@material-ui/lab/Skeleton\";\nimport Box from \"@material-ui/core/Box\";\nimport { ParsedUrlQuery } from \"querystring\";\nimport { PrismaClient } from \"@prisma/client\";\nimport { request } from \"graphql-request\";\nimport useSWR from \"swr\";\nconst prisma2 = new PrismaClient();\nimport CustomModal from '../../components/Modal';\nimport Router from \"next/router\";\nimport LazyLoad from 'react-lazyload';\n\nconst take = \"9\";\n\nconst API = \"http://localhost:3000/api/graphql\";\nconst fetcher = (query: any, skip: string, take: string) =>\n  request(API, query, { skip, take });\n\n\nconst ALL_PRODUCTS2 = /* GraphQL */ `\n  query allProducts($skip: String!, $take: String!) {\n    allProducts(skip: $skip, take: $take) {\n      id\n      name\n    }\n  }\n`;\n\n\nexport interface IProducts {\n  products: Product[];\n  numberPages: number;\n  skip: string;\n}\n\nexport default function Products({ skip, products, numberPages }: IProducts) {\n  const classes = useStyles();\n  const [open, setOpen] = useState(false);\n  const [openEdit, setOpenEdit] = useState(false);\n  const [activeProduct, setActiveProduct] = useState<Product>();\n\n\n  const { data } = useSWR([ALL_PRODUCTS2, skip, take], {\n    initialData: products,\n  });\n\n  const loading: boolean = !data;\n\n  const router = useRouter();\n  if (router.isFallback || loading) {\n    return <Loading />;\n  }\n\n  const handleOnclickDeleteBtn = async ( product: Product, e: any) => {\n    await handleOpen(e);// Active product. ...\n    await setActiveProduct(product);\n  }\n\n  const redirectRouting = async (currentPage: string) => {\n    await Router.replace(`/products/${currentPage}`,  `/products/${currentPage}`, {shallow: true})\n  }\n\n  const handleOpen = (e: any) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setOpen(true);\n  };\n\n  const handleClose = (e: any) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setOpen(false);\n  };\n\n  const handleOpenOrCloseEdit = (e: any) => {\n    e.preventDefault();\n    setOpenEdit(!openEdit);\n  };\n\n  // @ts-ignore\n  let updatedProducts = null;\n  console.log('ahuchccheck..',  updatedProducts)\n  const typeOfUpdateProducts = typeof data\n  if (typeOfUpdateProducts === \"object\") {\n    // @ts-ignore\n    updatedProducts = data?.allProducts\n  }\n\n  return (\n    <div className={classes.wrapper}>\n      {/* Break component ===>  */}\n      {open && (\n        activeProduct && <CustomModal\n            handleOpen={handleOpen}\n            product={activeProduct!}\n            handleClose={handleClose}\n            open={open}\n            redirectRouting={redirectRouting}\n            currentPage= {(router.query.page || 1) as string}\n            isEdit={false}\n          // @ts-ignore\n            products ={productArray || products || []}\n        />\n\n      )}\n      {openEdit? (<CustomModal\n          redirectRouting={redirectRouting}\n          product={activeProduct!}\n          currentPage= {(router.query.page || 1) as string}\n          handleClose={handleOpenOrCloseEdit}\n          handleOpen={handleOpenOrCloseEdit}\n          open={openEdit}\n          isEdit={true}\n          // @ts-ignore\n          products ={productArray || products || []}\n        />)\n        :null\n      }\n      <div className={classes.content__tittle}>\n        <div>POPULAR PRODUCTS</div>\n      </div>\n      <Box className={classes.content__pagination}>\n        {numberPages > 0 || !router.isFallback ? (\n          <Pagination\n            page={parseInt((router.query.page as string) || \"1\")}\n            count={numberPages}\n            defaultPage={1}\n            renderItem={(item) => (\n              <PaginationItem\n                component={MaterialUiLink}\n                query={router.query || 1}\n                item={item}\n                {...item}\n              />\n            )}\n          />\n        ) : (\n          <Skeleton variant=\"rect\" width={\"30vw\"} height={\"28px\"} />\n        )}\n      </Box>\n      <div className={classes.content__items}>\n        {(updatedProducts) ? (\n          updatedProducts.map((p: Product, i: any) => {\n            return (\n              <Box className={classes.lazyLoading}>\n                <LazyLoad\n                  key={p.id}\n                  height={9}\n                  offset={[-9,9]}\n                  placeholder={<Loading/>}\n                >\n                  <Link\n                    href=\"/products/details/[id]\"\n                    as={`/products/details/${p.id}`}\n                  >\n                    <Card key={i} className={classes.content__item}>\n                      <CardActionArea>\n                        <CardMedia\n                          className={classes.item__media}\n                          image=\"https://cdn.bike24.net/i/mb/d8/fa/b2/277893-00-d-557791.jpg\"\n                          title=\"Contemplative Reptile\"\n                        />\n                        <CardContent>\n                          <Typography gutterBottom variant=\"h5\" component=\"h2\">\n                            {p.name}\n                          </Typography>\n                          <Typography\n                            variant=\"body2\"\n                            color=\"textSecondary\"\n                            component=\"p\"\n                          >\n                            Maximum impact cushioning. The brutal, repetitive,\n                            downward force of sport can wreak havoc on the body and\n                            on performance. Max Air cushioning is specifically\n                            engineered to handle these impacts and provide\n                            protection. Max Air is big air designed to take a\n                            pounding.\n                          </Typography>\n                          <Typography className={classes.item__price}>\n                            PRICE: 60.0 Euro\n                          </Typography>\n                        </CardContent>\n                      </CardActionArea>\n                      <CardActions className={classes.item__buttons}>\n                        <Box component=\"div\">\n                          <Button\n                            size=\"small\"\n                            color=\"primary\"\n                            className={classes.button__addToCart}\n                          >\n                            Add To Cart\n                          </Button>\n                          <Button size=\"small\" color=\"primary\" onClick={handleOpenOrCloseEdit}>\n                            EDIT\n                          </Button>\n                        </Box>\n                        {/* Set active product ===> nhu */}\n                        <Button\n                          size=\"small\"\n                          color=\"primary\"\n                          onClick={(e) => handleOnclickDeleteBtn(p, e)}\n                        >\n                          Delete\n                        </Button>\n                      </CardActions>\n                    </Card>\n                  </Link>\n                </LazyLoad>\n              </Box>\n            );\n          })\n        ) : (\n          <Box className={classes.content__skeleton}>\n            <Skeleton variant=\"rect\" width={\"28vw\"} height={\"720px\"} />\n            <div className={classes.wrapper__loading}>\n              <Loading />\n            </div>\n          </Box>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport const getStaticProps: GetStaticProps = async (ctx) => {\n  const totalProducts = await prisma2.product.findMany();\n  const productsArray = Object.keys(totalProducts).map(\n    (k) => totalProducts[parseInt(k)]\n  );\n  const numberPages = Math.ceil(\n    ((productsArray?.length || 0) as number) / +take\n  ) as number;\n  const pageQuery = (ctx?.params?.page || 1) as string;\n\n  const skip = String((parseInt(pageQuery) - 1) * +take);\n\n  const productsOfPage = await prisma2.product.findMany({\n    skip: +skip,\n    take: +take\n  });\n\n  // const productsArrayOfPage = Object.keys(productsOfPage).map(\n  //   (k) => productsOfPage[parseInt(k)]\n  // );\n\n  // const {  data } = await client.query({\n  //   query: ALL_PRODUCTS,\n  //   variables: {\n  //     skip: skip,\n  //     take: take\n  //   }\n  // })\n\n  const a = {...productsOfPage}\n  const b = {\n    allProducts: [...a]\n  }\n  const products: Product[] = await fetcher(ALL_PRODUCTS2, skip, take);\n\n  console.log('productsArrayOfPage', b)\n  console.log('products', products)\n\n  return {\n    props: {\n      products: productsOfPage,\n      numberPages,\n      skip,\n    },\n  };\n};\n\nexport interface MaterialUiLinkProps {\n  item: PaginationRenderItemParams;\n  query: ParsedUrlQuery;\n}\n\nexport function MaterialUiLink({ item, query, ...props }: MaterialUiLinkProps) {\n  // const router = useRouter();\n  // if ( !router.query.page)\n  //   return (\n  //     <Link href=\"/products\" as={`/products`}>\n  //       <a {...props}></a>\n  //     </Link>\n  //   );\n\n  return (\n    <Link href=\"/products/[page]\" as={`/products/${item.page}`}>\n      <a {...props}></a>\n    </Link>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}